module.exports=[80148,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(56025);let f=({children:a})=>{let{token:f,loading:g}=(0,c.useContext)(e.AuthContext),h=(0,d.useRouter)();return(console.log("ProtectedRoute - loading:",g,"token:",f),g)?(0,b.jsx)("div",{children:"Loading..."}):f?(0,b.jsx)(b.Fragment,{children:a}):(h.push("/login"),null)};function g(a){return function(c){return(0,b.jsx)(f,{children:(0,b.jsx)(a,{...c})})}}a.s(["withProtectedRoute",()=>g],80148)},70298,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(56025);let e=()=>{let{user:a,token:e,refetchUser:f}=(0,c.useContext)(d.AuthContext),[g,h]=(0,c.useState)(!1),[i,j]=(0,c.useState)({name:"",lastname:"",nickname:"",tags:[],description:"",website:""}),[k,l]=(0,c.useState)(null),[m,n]=(0,c.useState)(""),o=(0,c.useRef)(null);(0,c.useEffect)(()=>{a&&j({name:a.name||"",lastname:a.lastname||"",nickname:a.nickname||"",tags:a.tags||[],description:a.description||"",website:a.website||""})},[a]);let{name:p,lastname:q,nickname:r,tags:s,description:t,website:u}=i,v=a=>j({...i,[a.target.name]:a.target.value}),w=async()=>{if(!k||!e)return;let a=new FormData;a.append("file",k);try{let b=await fetch("/api/files/upload",{method:"POST",headers:{"x-auth-token":e},body:a});if(!b.ok)throw Error("File upload failed");let{url:c}=await b.json();if(!(await fetch("/api/users/profile-picture",{method:"PUT",headers:{"Content-Type":"application/json","x-auth-token":e},body:JSON.stringify({url:c})})).ok)throw Error("Profile picture update failed");f(),l(null)}catch(a){console.error(a),n(a.message||"Failed to upload profile picture.")}},x=async a=>{if(a.preventDefault(),n(""),!p||!q)return void n("Name and Last Name are required.");try{let a=await fetch("/api/users/profile",{method:"PUT",headers:{"Content-Type":"application/json","x-auth-token":e||""},body:JSON.stringify(i)});if(!a.ok){let b=await a.json();throw Error(b.message||"Failed to update profile.")}f(),h(!1)}catch(a){console.error(a),n(a.message||"Failed to update profile.")}};return a?(0,b.jsxs)("div",{className:"w-1/4 p-4 space-y-4 bg-white rounded-lg shadow-md dark:bg-gray-800",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("img",{src:a.profilePicture||"https://via.placeholder.com/150",alt:"Profile",className:"object-cover w-32 h-32 mx-auto rounded-full cursor-pointer",onClick:()=>{o.current?.click()}}),(0,b.jsx)("input",{type:"file",ref:o,onChange:a=>{a.target.files&&a.target.files.length>0&&l(a.target.files[0])},className:"hidden",accept:"image/*"}),k&&(0,b.jsx)("button",{onClick:w,className:"w-full px-4 py-2 mt-2 font-bold text-white bg-green-500 rounded-md hover:bg-green-700",children:"Save Picture"})]}),(0,b.jsx)("h3",{className:"text-2xl font-bold text-center",children:a.username}),g?(0,b.jsxs)("form",{onSubmit:x,className:"space-y-4",children:[m&&(0,b.jsx)("p",{className:"text-red-500 text-center",children:m}),(0,b.jsx)("input",{type:"text",placeholder:"Name",name:"name",value:p,onChange:v,required:!0,className:"w-full px-4 py-2 bg-gray-200 border border-transparent rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700"}),(0,b.jsx)("input",{type:"text",placeholder:"Last Name",name:"lastname",value:q,onChange:v,required:!0,className:"w-full px-4 py-2 bg-gray-200 border border-transparent rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700"}),(0,b.jsx)("input",{type:"text",placeholder:"Nickname",name:"nickname",value:r,onChange:v,className:"w-full px-4 py-2 bg-gray-200 border border-transparent rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700"}),(0,b.jsx)("input",{type:"text",placeholder:"Tags (comma separated)",value:s.join(", "),onChange:a=>{j({...i,tags:a.target.value.split(",").map(a=>a.trim())})},className:"w-full px-4 py-2 bg-gray-200 border border-transparent rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700"}),(0,b.jsx)("textarea",{placeholder:"Description",name:"description",value:t,onChange:v,className:"w-full px-4 py-2 bg-gray-200 border border-transparent rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700"}),(0,b.jsx)("input",{type:"text",placeholder:"Website URL",name:"website",value:u,onChange:v,className:"w-full px-4 py-2 bg-gray-200 border border-transparent rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700"}),(0,b.jsx)("button",{type:"submit",className:"w-full px-4 py-2 font-bold text-white bg-blue-500 rounded-md hover:bg-blue-700",children:"Save"}),(0,b.jsx)("button",{type:"button",onClick:()=>h(!1),className:"w-full px-4 py-2 mt-2 font-bold text-white bg-gray-500 rounded-md hover:bg-gray-700",children:"Cancel"})]}):(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Name:"})," ",a.name]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Last Name:"})," ",a.lastname]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Nickname:"})," ",a.nickname]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Description:"})," ",a.description]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Website:"})," ",(0,b.jsx)("a",{href:a.website,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:a.website})]}),(0,b.jsx)("div",{className:"flex py-2 flex-wrap gap-2",children:a.tags&&a.tags.map(a=>(0,b.jsx)("span",{className:"px-2 py-1 text-sm text-white bg-blue-500 rounded-full",children:a},a))}),(0,b.jsx)("button",{onClick:()=>h(!0),className:"w-full px-4 py-2 font-bold text-white bg-blue-500 rounded-md hover:bg-blue-700",children:"Edit Profile"})]})]}):(0,b.jsx)("div",{children:"Loading..."})},f=()=>{let{user:a}=(0,c.useContext)(d.AuthContext),[e,f]=(0,c.useState)(null);return a&&a.catalog&&0!==a.catalog.length?(0,b.jsxs)("div",{className:"p-4 space-y-4 bg-white rounded-lg shadow-md dark:bg-gray-800",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold",children:"My Catalog"}),(0,b.jsx)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",children:a.catalog.map(a=>(0,b.jsxs)("div",{onClick:()=>{f(a)},className:"p-4 space-y-2 bg-gray-200 rounded-lg shadow-md cursor-pointer dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600",children:[(0,b.jsx)("h4",{className:"text-lg font-bold",children:a.title}),"image"===a.mediaType&&(0,b.jsx)("img",{src:a.mediaUrl,alt:a.title,className:"w-full rounded-md"}),"video"===a.mediaType&&(0,b.jsx)("video",{src:a.mediaUrl,controls:!0,className:"w-full rounded-md"}),(0,b.jsx)("p",{children:a.description})]},a._id))}),e&&(0,b.jsx)("div",{className:"fixed top-0 left-0 flex items-center justify-center w-full h-full bg-black bg-opacity-80",onClick:()=>{f(null)},children:(0,b.jsxs)("div",{className:"p-8 m-4 space-y-4 overflow-auto bg-white rounded-lg shadow-md max-w-3xl max-h-3/4 dark:bg-gray-800",children:[(0,b.jsx)("h2",{className:"text-3xl font-bold",children:e.title}),"image"===e.mediaType&&(0,b.jsx)("img",{src:e.mediaUrl,alt:e.title,className:"w-full rounded-md"}),"video"===e.mediaType&&(0,b.jsx)("video",{src:e.mediaUrl,controls:!0,className:"w-full rounded-md"}),(0,b.jsx)("p",{children:e.description})]})})]}):(0,b.jsx)("div",{children:"No catalog items."})},g=()=>{let{user:a,token:e,refetchUser:g}=(0,c.useContext)(d.AuthContext),[h,i]=(0,c.useState)(""),[j,k]=(0,c.useState)([]),l=async a=>{if(a.preventDefault(),h)try{let a=await fetch(`/api/users/search?query=${h}`,{headers:{"x-auth-token":e||""}}),b=await a.json();k(b)}catch(a){console.error(a)}},m=async a=>{try{await fetch(`/api/users/contacts/add/${a}`,{method:"POST",headers:{"x-auth-token":e||""}}),g()}catch(a){console.error(a)}},n=async a=>{try{await fetch(`/api/users/contacts/remove/${a}`,{method:"DELETE",headers:{"x-auth-token":e||""}}),g()}catch(a){console.error(a)}};return a?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"flex-1 p-4 space-y-4 bg-white rounded-lg shadow-md dark:bg-gray-800",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"mb-2 text-xl font-bold",children:"Rooms"}),(0,b.jsx)("ul",{className:"space-y-2",children:a.rooms&&a.rooms.map(a=>(0,b.jsx)("li",{className:"p-2 bg-gray-200 rounded-md dark:bg-gray-700",children:a},a))})]}),(0,b.jsx)(f,{})]}),(0,b.jsxs)("div",{className:"flex-1 p-4 space-y-4 bg-white rounded-lg shadow-md dark:bg-gray-800",children:[(0,b.jsx)("h4",{className:"mb-2 text-xl font-bold",children:"Contacts"}),(0,b.jsx)("ul",{className:"space-y-2",children:a.contacts&&a.contacts.map(a=>(0,b.jsxs)("li",{className:"flex items-center justify-between p-2 bg-gray-200 rounded-md dark:bg-gray-700",children:[(0,b.jsx)("span",{children:a.username}),(0,b.jsx)("button",{onClick:()=>n(a._id),className:"px-3 py-1 font-bold text-white bg-red-500 rounded-md hover:bg-red-700",children:"Remove"})]},a._id))}),(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsx)("h5",{className:"mb-2 text-lg font-bold",children:"Add Contact"}),(0,b.jsxs)("form",{onSubmit:l,className:"flex",children:[(0,b.jsx)("input",{type:"text",placeholder:"Search for users...",value:h,onChange:a=>i(a.target.value),className:"flex-1 px-4 py-2 mr-2 bg-gray-200 border border-transparent rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700"}),(0,b.jsx)("button",{type:"submit",className:"px-4 py-2 font-bold text-white bg-blue-500 rounded-md hover:bg-blue-700",children:"Search"})]}),(0,b.jsx)("ul",{className:"mt-2 space-y-2",children:j.map(a=>(0,b.jsxs)("li",{className:"flex items-center justify-between p-2 bg-gray-200 rounded-md dark:bg-gray-700",children:[(0,b.jsx)("span",{children:a.username}),(0,b.jsx)("button",{onClick:()=>m(a._id),className:"px-3 py-1 font-bold text-white bg-green-500 rounded-md hover:bg-green-700",children:"Add"})]},a._id))})]})]})]}):(0,b.jsx)("div",{children:"Loading..."})},h=()=>{let{user:a}=(0,c.useContext)(d.AuthContext);return a?(0,b.jsxs)("div",{className:"flex h-full p-4 space-x-4 bg-gray-100 dark:bg-gray-900",children:[(0,b.jsx)(e,{}),(0,b.jsx)(g,{})]}):(0,b.jsx)("div",{children:"Loading profile..."})},i=(0,a.i(80148).withProtectedRoute)(()=>(0,b.jsx)(h,{}));a.s(["default",0,i],70298)}];

//# sourceMappingURL=src_app_e609b43a._.js.map
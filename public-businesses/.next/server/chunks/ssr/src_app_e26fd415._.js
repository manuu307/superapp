module.exports=[80148,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(56025);let f=({children:a})=>{let{token:f,loading:g}=(0,c.useContext)(e.AuthContext),h=(0,d.useRouter)();return(console.log("ProtectedRoute - loading:",g,"token:",f),g)?(0,b.jsx)("div",{children:"Loading..."}):f?(0,b.jsx)(b.Fragment,{children:a}):(h.push("/login"),null)};function g(a){return function(c){return(0,b.jsx)(f,{children:(0,b.jsx)(a,{...c})})}}a.s(["withProtectedRoute",()=>g],80148)},40777,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(74451);let e=({token:a,onRoomCreated:d})=>{let[e,f]=(0,c.useState)(""),[g,h]=(0,c.useState)(""),[i,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)(""),[m,n]=(0,c.useState)([]),[o,p]=(0,c.useState)([]),[q,r]=(0,c.useState)([]),[s,t]=(0,c.useState)(null),u=(0,c.useCallback)(async()=>{if(a)try{let b=await fetch("/api/users",{headers:{"x-auth-token":a}});if(!b.ok)throw Error("Failed to fetch users");let c=await b.json();n(c)}catch(a){console.error("Error fetching users:",a),t(a.message||"Failed to fetch users.")}},[a]);(0,c.useEffect)(()=>{u()},[u]);let v=async b=>{if(b.preventDefault(),t(null),!e)return void t("Room name is required.");if(!a)return void t("Authentication token not found. Please log in.");try{let b=await fetch("/api/rooms",{method:"POST",headers:{"Content-Type":"application/json","x-auth-token":a},body:JSON.stringify({name:e,description:g,isPrivate:i,tags:k.split(",").map(a=>a.trim()),users:o,admins:q})}),c=await b.json();if(!b.ok)throw Error(c.message||"Failed to create room");d(c.name),f(""),h(""),j(!1),l(""),p([]),r([])}catch(a){t(a.message||"An error occurred while creating the room.")}};return(0,b.jsxs)("div",{className:"p-4 my-4 bg-white rounded-md shadow-md dark:bg-gray-800",children:[(0,b.jsx)("h3",{className:"mb-4 text-xl font-bold text-center",children:"Create a New Room"}),s&&(0,b.jsx)("p",{className:"p-2 mb-4 text-white bg-red-500 rounded-md",children:s}),(0,b.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,b.jsx)("input",{type:"text",placeholder:"Room Name",value:e,onChange:a=>f(a.target.value),required:!0,className:"w-full px-4 py-2 bg-gray-200 border border-transparent rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700"}),(0,b.jsx)("textarea",{placeholder:"Description",value:g,onChange:a=>h(a.target.value),className:"w-full px-4 py-2 bg-gray-200 border border-transparent rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700"}),(0,b.jsx)("div",{children:(0,b.jsxs)("label",{className:"flex items-center",children:[(0,b.jsx)("input",{type:"checkbox",checked:i,onChange:a=>j(a.target.checked),className:"mr-2"}),"Private Room"]})}),(0,b.jsx)("input",{type:"text",placeholder:"Tags (comma-separated)",value:k,onChange:a=>l(a.target.value),className:"w-full px-4 py-2 bg-gray-200 border border-transparent rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"mb-2 font-bold",children:"Users"}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-2",children:m.map(a=>(0,b.jsx)("div",{children:(0,b.jsxs)("label",{className:"flex items-center",children:[(0,b.jsx)("input",{type:"checkbox",onChange:()=>{var b;return b=a._id,void p(a=>a.includes(b)?a.filter(a=>a!==b):[...a,b])},className:"mr-2",checked:o.includes(a._id)}),a.username]})},a._id))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"mb-2 font-bold",children:"Admins"}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-2",children:o.map(a=>{let c=m.find(b=>b._id===a);return c?(0,b.jsx)("div",{children:(0,b.jsxs)("label",{className:"flex items-center",children:[(0,b.jsx)("input",{type:"checkbox",onChange:()=>{var a;return a=c._id,void r(b=>b.includes(a)?b.filter(b=>b!==a):[...b,a])},className:"mr-2",checked:q.includes(c._id)}),c.username]})},c._id):null})})]}),(0,b.jsx)("button",{type:"submit",className:"w-full px-4 py-2 font-bold text-white bg-blue-500 rounded-md hover:bg-blue-700",children:"Create Room"})]})]})};var f=a.i(56025),g=a.i(80148);let h=()=>{let{room:a,setRoom:g,rooms:h,message:i,setMessage:j,chat:k,sendMessage:l,showCreateRoom:m,setShowCreateRoom:n,handleRoomCreated:o,handleFileUpload:p}=(0,c.useContext)(d.SocialContext),{user:q,token:r}=(0,c.useContext)(f.AuthContext);return(0,b.jsxs)("div",{className:"flex h-full",children:[(0,b.jsxs)("div",{className:"flex flex-col w-1/4 p-4 bg-white border-r border-gray-200 dark:bg-gray-800 dark:border-gray-700",children:[(0,b.jsx)("h2",{className:"mb-4 text-xl font-bold",children:"Rooms"}),(0,b.jsx)("button",{onClick:()=>n(!m),className:"w-full px-4 py-2 mb-4 font-bold text-white bg-green-500 rounded-md hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-900",children:m?"Cancel":"Create Room"}),m&&(0,b.jsx)(e,{token:r,onRoomCreated:o}),(0,b.jsx)("ul",{className:"overflow-y-auto",children:h.map(c=>(0,b.jsx)("li",{onClick:()=>g(c),className:`p-2 cursor-pointer rounded-md ${c===a?"bg-blue-500 text-white":"hover:bg-gray-200 dark:hover:bg-gray-700"}`,children:c},c))})]}),(0,b.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,b.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:(0,b.jsx)("h3",{className:"text-xl font-bold",children:a})}),(0,b.jsx)("div",{className:"flex-1 p-4 overflow-y-auto",children:k.map((a,c)=>(0,b.jsx)("div",{className:`flex mb-4 ${a.sender===q?.username?"justify-end":"justify-start"}`,children:(0,b.jsxs)("div",{className:`p-3 rounded-lg ${a.sender===q?.username?"bg-blue-500 text-white":"bg-gray-300 dark:bg-gray-700"}`,children:[(0,b.jsx)("div",{className:"text-sm font-bold",children:a.sender}),(0,b.jsx)("div",{className:"text-lg",children:a.text.startsWith("http://")&&(a.text.endsWith(".jpg")||a.text.endsWith(".png")||a.text.endsWith(".gif"))?(0,b.jsx)("img",{src:a.text,alt:"Uploaded content",className:"max-w-xs rounded-md"}):a.text}),(0,b.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(a.timestamp).toLocaleTimeString()})]})},c))}),(0,b.jsxs)("form",{className:"flex p-4 border-t border-gray-200 dark:border-gray-700",onSubmit:l,children:[(0,b.jsx)("input",{type:"text",value:i,placeholder:"Type a message...",onChange:a=>j(a.target.value),className:"flex-1 px-4 py-2 mr-2 bg-gray-200 border border-transparent rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700"}),(0,b.jsx)("input",{type:"file",id:"file-input",className:"hidden",onChange:p}),(0,b.jsx)("label",{htmlFor:"file-input",className:"p-2 text-gray-500 cursor-pointer hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:"ðŸ“Ž"}),(0,b.jsx)("button",{type:"submit",className:"px-4 py-2 font-bold text-white bg-blue-500 rounded-md hover:bg-blue-700",children:"Send"})]})]})]})},i=(0,g.withProtectedRoute)(()=>(0,b.jsx)(d.SocialProvider,{children:(0,b.jsx)(h,{})}));a.s(["default",0,i],40777)}];

//# sourceMappingURL=src_app_e26fd415._.js.map
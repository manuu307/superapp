(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,92355,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(18566),s=e.i(32341);let l=({children:e})=>{let{token:l,loading:n}=(0,a.useContext)(s.AuthContext),o=(0,r.useRouter)();return(console.log("ProtectedRoute - loading:",n,"token:",l),n)?(0,t.jsx)("div",{children:"Loading..."}):l?(0,t.jsx)(t.Fragment,{children:e}):(o.push("/login"),null)};function n(e){return function(a){return(0,t.jsx)(l,{children:(0,t.jsx)(e,{...a})})}}e.s(["withProtectedRoute",()=>n],92355)},13278,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(32341);let s=()=>{let{user:e,token:s,refetchUser:l}=(0,a.useContext)(r.AuthContext),[n,o]=(0,a.useState)(!1),[d,i]=(0,a.useState)({name:"",lastname:"",nickname:"",tags:[],description:"",website:""}),[c,u]=(0,a.useState)(null),[g,m]=(0,a.useState)(""),h=(0,a.useRef)(null);(0,a.useEffect)(()=>{e&&i({name:e.name||"",lastname:e.lastname||"",nickname:e.nickname||"",tags:e.tags||[],description:e.description||"",website:e.website||""})},[e]);let{name:p,lastname:x,nickname:b,tags:f,description:y,website:j}=d,w=e=>i({...d,[e.target.name]:e.target.value}),N=async()=>{if(!c||!s)return;let e=new FormData;e.append("file",c);try{let t=await fetch("/api/files/upload",{method:"POST",headers:{"x-auth-token":s},body:e});if(!t.ok)throw Error("File upload failed");let{url:a}=await t.json();if(!(await fetch("/api/users/profile-picture",{method:"PUT",headers:{"Content-Type":"application/json","x-auth-token":s},body:JSON.stringify({url:a})})).ok)throw Error("Profile picture update failed");l(),u(null)}catch(e){console.error(e),m(e.message||"Failed to upload profile picture.")}},v=async e=>{if(e.preventDefault(),m(""),!p||!x)return void m("Name and Last Name are required.");try{let e=await fetch("/api/users/profile",{method:"PUT",headers:{"Content-Type":"application/json","x-auth-token":s||""},body:JSON.stringify(d)});if(!e.ok){let t=await e.json();throw Error(t.message||"Failed to update profile.")}l(),o(!1)}catch(e){console.error(e),m(e.message||"Failed to update profile.")}};return e?(0,t.jsxs)("div",{className:"w-1/4 p-4 space-y-4 bg-white rounded-lg shadow-md dark:bg-gray-800",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("img",{src:e.profilePicture||"https://via.placeholder.com/150",alt:"Profile",className:"object-cover w-32 h-32 mx-auto rounded-full cursor-pointer",onClick:()=>{h.current?.click()}}),(0,t.jsx)("input",{type:"file",ref:h,onChange:e=>{e.target.files&&e.target.files.length>0&&u(e.target.files[0])},className:"hidden",accept:"image/*"}),c&&(0,t.jsx)("button",{onClick:N,className:"w-full px-4 py-2 mt-2 font-bold text-white bg-green-500 rounded-md hover:bg-green-700",children:"Save Picture"})]}),(0,t.jsx)("h3",{className:"text-2xl font-bold text-center",children:e.username}),n?(0,t.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[g&&(0,t.jsx)("p",{className:"text-red-500 text-center",children:g}),(0,t.jsx)("input",{type:"text",placeholder:"Name",name:"name",value:p,onChange:w,required:!0,className:"w-full px-4 py-2 bg-gray-200 border border-transparent rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700"}),(0,t.jsx)("input",{type:"text",placeholder:"Last Name",name:"lastname",value:x,onChange:w,required:!0,className:"w-full px-4 py-2 bg-gray-200 border border-transparent rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700"}),(0,t.jsx)("input",{type:"text",placeholder:"Nickname",name:"nickname",value:b,onChange:w,className:"w-full px-4 py-2 bg-gray-200 border border-transparent rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700"}),(0,t.jsx)("input",{type:"text",placeholder:"Tags (comma separated)",value:f.join(", "),onChange:e=>{i({...d,tags:e.target.value.split(",").map(e=>e.trim())})},className:"w-full px-4 py-2 bg-gray-200 border border-transparent rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700"}),(0,t.jsx)("textarea",{placeholder:"Description",name:"description",value:y,onChange:w,className:"w-full px-4 py-2 bg-gray-200 border border-transparent rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700"}),(0,t.jsx)("input",{type:"text",placeholder:"Website URL",name:"website",value:j,onChange:w,className:"w-full px-4 py-2 bg-gray-200 border border-transparent rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700"}),(0,t.jsx)("button",{type:"submit",className:"w-full px-4 py-2 font-bold text-white bg-blue-500 rounded-md hover:bg-blue-700",children:"Save"}),(0,t.jsx)("button",{type:"button",onClick:()=>o(!1),className:"w-full px-4 py-2 mt-2 font-bold text-white bg-gray-500 rounded-md hover:bg-gray-700",children:"Cancel"})]}):(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Name:"})," ",e.name]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Last Name:"})," ",e.lastname]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Nickname:"})," ",e.nickname]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Description:"})," ",e.description]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Website:"})," ",(0,t.jsx)("a",{href:e.website,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:e.website})]}),(0,t.jsx)("div",{className:"flex py-2 flex-wrap gap-2",children:e.tags&&e.tags.map(e=>(0,t.jsx)("span",{className:"px-2 py-1 text-sm text-white bg-blue-500 rounded-full",children:e},e))}),(0,t.jsx)("button",{onClick:()=>o(!0),className:"w-full px-4 py-2 font-bold text-white bg-blue-500 rounded-md hover:bg-blue-700",children:"Edit Profile"})]})]}):(0,t.jsx)("div",{children:"Loading..."})},l=()=>{let{user:e}=(0,a.useContext)(r.AuthContext),[s,l]=(0,a.useState)(null);return e&&e.catalog&&0!==e.catalog.length?(0,t.jsxs)("div",{className:"p-4 space-y-4 bg-white rounded-lg shadow-md dark:bg-gray-800",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold",children:"My Catalog"}),(0,t.jsx)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",children:e.catalog.map(e=>(0,t.jsxs)("div",{onClick:()=>{l(e)},className:"p-4 space-y-2 bg-gray-200 rounded-lg shadow-md cursor-pointer dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600",children:[(0,t.jsx)("h4",{className:"text-lg font-bold",children:e.title}),"image"===e.mediaType&&(0,t.jsx)("img",{src:e.mediaUrl,alt:e.title,className:"w-full rounded-md"}),"video"===e.mediaType&&(0,t.jsx)("video",{src:e.mediaUrl,controls:!0,className:"w-full rounded-md"}),(0,t.jsx)("p",{children:e.description})]},e._id))}),s&&(0,t.jsx)("div",{className:"fixed top-0 left-0 flex items-center justify-center w-full h-full bg-black bg-opacity-80",onClick:()=>{l(null)},children:(0,t.jsxs)("div",{className:"p-8 m-4 space-y-4 overflow-auto bg-white rounded-lg shadow-md max-w-3xl max-h-3/4 dark:bg-gray-800",children:[(0,t.jsx)("h2",{className:"text-3xl font-bold",children:s.title}),"image"===s.mediaType&&(0,t.jsx)("img",{src:s.mediaUrl,alt:s.title,className:"w-full rounded-md"}),"video"===s.mediaType&&(0,t.jsx)("video",{src:s.mediaUrl,controls:!0,className:"w-full rounded-md"}),(0,t.jsx)("p",{children:s.description})]})})]}):(0,t.jsx)("div",{children:"No catalog items."})},n=()=>{let{user:e,token:s,refetchUser:n}=(0,a.useContext)(r.AuthContext),[o,d]=(0,a.useState)(""),[i,c]=(0,a.useState)([]),u=async e=>{if(e.preventDefault(),o)try{let e=await fetch(`/api/users/search?query=${o}`,{headers:{"x-auth-token":s||""}}),t=await e.json();c(t)}catch(e){console.error(e)}},g=async e=>{try{await fetch(`/api/users/contacts/add/${e}`,{method:"POST",headers:{"x-auth-token":s||""}}),n()}catch(e){console.error(e)}},m=async e=>{try{await fetch(`/api/users/contacts/remove/${e}`,{method:"DELETE",headers:{"x-auth-token":s||""}}),n()}catch(e){console.error(e)}};return e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex-1 p-4 space-y-4 bg-white rounded-lg shadow-md dark:bg-gray-800",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"mb-2 text-xl font-bold",children:"Rooms"}),(0,t.jsx)("ul",{className:"space-y-2",children:e.rooms&&e.rooms.map(e=>(0,t.jsx)("li",{className:"p-2 bg-gray-200 rounded-md dark:bg-gray-700",children:e},e))})]}),(0,t.jsx)(l,{})]}),(0,t.jsxs)("div",{className:"flex-1 p-4 space-y-4 bg-white rounded-lg shadow-md dark:bg-gray-800",children:[(0,t.jsx)("h4",{className:"mb-2 text-xl font-bold",children:"Contacts"}),(0,t.jsx)("ul",{className:"space-y-2",children:e.contacts&&e.contacts.map(e=>(0,t.jsxs)("li",{className:"flex items-center justify-between p-2 bg-gray-200 rounded-md dark:bg-gray-700",children:[(0,t.jsx)("span",{children:e.username}),(0,t.jsx)("button",{onClick:()=>m(e._id),className:"px-3 py-1 font-bold text-white bg-red-500 rounded-md hover:bg-red-700",children:"Remove"})]},e._id))}),(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("h5",{className:"mb-2 text-lg font-bold",children:"Add Contact"}),(0,t.jsxs)("form",{onSubmit:u,className:"flex",children:[(0,t.jsx)("input",{type:"text",placeholder:"Search for users...",value:o,onChange:e=>d(e.target.value),className:"flex-1 px-4 py-2 mr-2 bg-gray-200 border border-transparent rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700"}),(0,t.jsx)("button",{type:"submit",className:"px-4 py-2 font-bold text-white bg-blue-500 rounded-md hover:bg-blue-700",children:"Search"})]}),(0,t.jsx)("ul",{className:"mt-2 space-y-2",children:i.map(e=>(0,t.jsxs)("li",{className:"flex items-center justify-between p-2 bg-gray-200 rounded-md dark:bg-gray-700",children:[(0,t.jsx)("span",{children:e.username}),(0,t.jsx)("button",{onClick:()=>g(e._id),className:"px-3 py-1 font-bold text-white bg-green-500 rounded-md hover:bg-green-700",children:"Add"})]},e._id))})]})]})]}):(0,t.jsx)("div",{children:"Loading..."})},o=()=>{let{user:e}=(0,a.useContext)(r.AuthContext);return e?(0,t.jsxs)("div",{className:"flex h-full p-4 space-x-4 bg-gray-100 dark:bg-gray-900",children:[(0,t.jsx)(s,{}),(0,t.jsx)(n,{})]}):(0,t.jsx)("div",{children:"Loading profile..."})},d=(0,e.i(92355).withProtectedRoute)(()=>(0,t.jsx)(o,{}));e.s(["default",0,d],13278)}]);
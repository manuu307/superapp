(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,92355,e=>{"use strict";var r=e.i(43476),t=e.i(71645),s=e.i(18566),a=e.i(32341);let l=({children:e})=>{let{token:l,loading:n}=(0,t.useContext)(a.AuthContext),o=(0,s.useRouter)();return(console.log("ProtectedRoute - loading:",n,"token:",l),n)?(0,r.jsx)("div",{children:"Loading..."}):l?(0,r.jsx)(r.Fragment,{children:e}):(o.push("/login"),null)};function n(e){return function(t){return(0,r.jsx)(l,{children:(0,r.jsx)(e,{...t})})}}e.s(["withProtectedRoute",()=>n],92355)},52683,e=>{"use strict";var r=e.i(43476),t=e.i(71645),s=e.i(23265);let a=({token:e,onRoomCreated:s})=>{let[a,l]=(0,t.useState)(""),[n,o]=(0,t.useState)(""),[d,i]=(0,t.useState)(!1),[c,u]=(0,t.useState)(""),[x,m]=(0,t.useState)([]),[h,g]=(0,t.useState)([]),[b,p]=(0,t.useState)([]),[f,j]=(0,t.useState)(null),y=(0,t.useCallback)(async()=>{if(e)try{let r=await fetch("/api/users",{headers:{"x-auth-token":e}});if(!r.ok)throw Error("Failed to fetch users");let t=await r.json();m(t)}catch(e){console.error("Error fetching users:",e),j(e.message||"Failed to fetch users.")}},[e]);(0,t.useEffect)(()=>{y()},[y]);let v=async r=>{if(r.preventDefault(),j(null),!a)return void j("Room name is required.");if(!e)return void j("Authentication token not found. Please log in.");try{let r=await fetch("/api/rooms",{method:"POST",headers:{"Content-Type":"application/json","x-auth-token":e},body:JSON.stringify({name:a,description:n,isPrivate:d,tags:c.split(",").map(e=>e.trim()),users:h,admins:b})}),t=await r.json();if(!r.ok)throw Error(t.message||"Failed to create room");s(t.name),l(""),o(""),i(!1),u(""),g([]),p([])}catch(e){j(e.message||"An error occurred while creating the room.")}};return(0,r.jsxs)("div",{className:"p-4 my-4 bg-white rounded-md shadow-md dark:bg-gray-800",children:[(0,r.jsx)("h3",{className:"mb-4 text-xl font-bold text-center",children:"Create a New Room"}),f&&(0,r.jsx)("p",{className:"p-2 mb-4 text-white bg-red-500 rounded-md",children:f}),(0,r.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,r.jsx)("input",{type:"text",placeholder:"Room Name",value:a,onChange:e=>l(e.target.value),required:!0,className:"w-full px-4 py-2 bg-gray-200 border border-transparent rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700"}),(0,r.jsx)("textarea",{placeholder:"Description",value:n,onChange:e=>o(e.target.value),className:"w-full px-4 py-2 bg-gray-200 border border-transparent rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700"}),(0,r.jsx)("div",{children:(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",checked:d,onChange:e=>i(e.target.checked),className:"mr-2"}),"Private Room"]})}),(0,r.jsx)("input",{type:"text",placeholder:"Tags (comma-separated)",value:c,onChange:e=>u(e.target.value),className:"w-full px-4 py-2 bg-gray-200 border border-transparent rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"mb-2 font-bold",children:"Users"}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-2",children:x.map(e=>(0,r.jsx)("div",{children:(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",onChange:()=>{var r;return r=e._id,void g(e=>e.includes(r)?e.filter(e=>e!==r):[...e,r])},className:"mr-2",checked:h.includes(e._id)}),e.username]})},e._id))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"mb-2 font-bold",children:"Admins"}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-2",children:h.map(e=>{let t=x.find(r=>r._id===e);return t?(0,r.jsx)("div",{children:(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",onChange:()=>{var e;return e=t._id,void p(r=>r.includes(e)?r.filter(r=>r!==e):[...r,e])},className:"mr-2",checked:b.includes(t._id)}),t.username]})},t._id):null})})]}),(0,r.jsx)("button",{type:"submit",className:"w-full px-4 py-2 font-bold text-white bg-blue-500 rounded-md hover:bg-blue-700",children:"Create Room"})]})]})};var l=e.i(32341),n=e.i(92355);let o=()=>{let{room:e,setRoom:n,rooms:o,message:d,setMessage:i,chat:c,sendMessage:u,showCreateRoom:x,setShowCreateRoom:m,handleRoomCreated:h,handleFileUpload:g}=(0,t.useContext)(s.SocialContext),{user:b,token:p}=(0,t.useContext)(l.AuthContext);return(0,r.jsxs)("div",{className:"flex h-full",children:[(0,r.jsxs)("div",{className:"flex flex-col w-1/4 p-4 bg-white border-r border-gray-200 dark:bg-gray-800 dark:border-gray-700",children:[(0,r.jsx)("h2",{className:"mb-4 text-xl font-bold",children:"Rooms"}),(0,r.jsx)("button",{onClick:()=>m(!x),className:"w-full px-4 py-2 mb-4 font-bold text-white bg-green-500 rounded-md hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-900",children:x?"Cancel":"Create Room"}),x&&(0,r.jsx)(a,{token:p,onRoomCreated:h}),(0,r.jsx)("ul",{className:"overflow-y-auto",children:o.map(t=>(0,r.jsx)("li",{onClick:()=>n(t),className:`p-2 cursor-pointer rounded-md ${t===e?"bg-blue-500 text-white":"hover:bg-gray-200 dark:hover:bg-gray-700"}`,children:t},t))})]}),(0,r.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,r.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:(0,r.jsx)("h3",{className:"text-xl font-bold",children:e})}),(0,r.jsx)("div",{className:"flex-1 p-4 overflow-y-auto",children:c.map((e,t)=>(0,r.jsx)("div",{className:`flex mb-4 ${e.sender===b?.username?"justify-end":"justify-start"}`,children:(0,r.jsxs)("div",{className:`p-3 rounded-lg ${e.sender===b?.username?"bg-blue-500 text-white":"bg-gray-300 dark:bg-gray-700"}`,children:[(0,r.jsx)("div",{className:"text-sm font-bold",children:e.sender}),(0,r.jsx)("div",{className:"text-lg",children:e.text.startsWith("http://")&&(e.text.endsWith(".jpg")||e.text.endsWith(".png")||e.text.endsWith(".gif"))?(0,r.jsx)("img",{src:e.text,alt:"Uploaded content",className:"max-w-xs rounded-md"}):e.text}),(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(e.timestamp).toLocaleTimeString()})]})},t))}),(0,r.jsxs)("form",{className:"flex p-4 border-t border-gray-200 dark:border-gray-700",onSubmit:u,children:[(0,r.jsx)("input",{type:"text",value:d,placeholder:"Type a message...",onChange:e=>i(e.target.value),className:"flex-1 px-4 py-2 mr-2 bg-gray-200 border border-transparent rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700"}),(0,r.jsx)("input",{type:"file",id:"file-input",className:"hidden",onChange:g}),(0,r.jsx)("label",{htmlFor:"file-input",className:"p-2 text-gray-500 cursor-pointer hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:"ðŸ“Ž"}),(0,r.jsx)("button",{type:"submit",className:"px-4 py-2 font-bold text-white bg-blue-500 rounded-md hover:bg-blue-700",children:"Send"})]})]})]})},d=(0,n.withProtectedRoute)(()=>(0,r.jsx)(s.SocialProvider,{children:(0,r.jsx)(o,{})}));e.s(["default",0,d],52683)}]);